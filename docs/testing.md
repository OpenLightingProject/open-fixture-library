# Testing

We try to develop unit tests whereever possible. They test specific components of our project by respecting the [F.I.R.S.T Principles of Unit Testing](https://github.com/ghsukumar/SFDC_Best_Practices/wiki/F.I.R.S.T-Principles-of-Unit-Testing):

- **Fast** – Tests that need too long time would annoy the workflow
- **Isolated** – Tests should not affect each other. *Travis* helps a lot at fulfilling this principle.
- **Repeatable** – Tests should be independent from the current environment and other side effects.
- **Self-Validating** – A test should either pass or fail, no manual inspection is needed to determine the state.
- **Timely** – With new features, also new tests have to be implemented

Tests are located in the [`tests/`](../tests/) directory (surprise!), one test per file. They can be called manually except of the GitHub tests in [`tests/github/`](../tests/github/) (see below).

We use [Travis](https://travis-ci.org/) for continuous integration (CI): It runs our specified tests with every GitHub commit. The [`.travis.yml`](../.travis.yml) file lists each test as different environment, each of them is set up seperately when being executed. The exit code that a test script returns tells Travis whether it has passed or failed: Tests with `0` exit code (in NodeJS: `process.exit(0);`) have passed, all others (non-zero exit codes) have failed.

The GitHub repository is configured in a way that pull requests with failing tests can't be merged, that means the tests are required. To implement optional tests that don't prevent a PR from being merged, just make it always pass (with exit code `0`) and warn the developers via console output or a GitHub comment.

Some tests rely on the information on what files have been changed in a PR; they are called GitHub tests, are located in `tests/github/` and use the helper module [`pull-request.js`](../tests/github/pull-request.js). They need some environment variables provided by Travis to identify the current pull request and the current commit hash, one of the reasons why they can't be called manually. The `pull-request.js` module can also be used by other non-GitHub tests to create warning comments.

Running a test case against the whole fixture library would be too much effort in most cases. The test fixture collection ([`tests/test-fixtures.json`](../tests/test-fixtures.json)) is a set of test fixtures that cover all defined [Fixture features](fixture-features.md) (while keeping the set as small as possible). Running tests only against these fixtures ensures a broad coverage with minimal effort. The set can be generated by calling [`cli/make-test-fixtures.js`](../cli/make-test-fixtures.js) or simply `make`.
